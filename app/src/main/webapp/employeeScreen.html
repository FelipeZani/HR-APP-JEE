<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Employees</title>

    <link rel="stylesheet" href="css/employeeScreen.css">

    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
        integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz" crossorigin="anonymous">
        </script>

    <script type="module" src="./ts/dist/employeeScreen/employeeScreen.js" defer></script>
    <script type="module" src="./ts/dist/employeeScreen/newEmployee.js" defer></script>
    <script type="module" src="./ts/dist/employeeScreen/removeEmployee.js" defer></script>
    <script type="module" src="./ts/dist/employeeScreen/modifyEmployee.js" defer></script>

    <!-- Using HTTP requests only when it's necessary to append dynamic content directly from the database into the DOM -->
    <!-- HTTP requests are sent to a central endpoint and only the redirected to their respective destinations, we are using hidden inputs as filters -->

</head>

<body>
    <main>
        <h1>Employees</h1>
        <!-- Hidden inputs appear throughout the code, they are meant to be filtered by the database in order to treat each request -->
        <div id="tools-wrapper" style="display: flex; justify-content: flex-end; ">

            <!-- <a href="http://localhost:8080/app/report/employees" target="_blank" style="text-decoration: none;">
                <button type="button" style="cursor: pointer;">ðŸ“„ PDF</button>
            </a> -->
            <button id="dashboard-btn" class="btn-secondary" style="background-color: #6c5ce7; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer;">
                ðŸ“Š Dashboard RH
            </button>
            <button id="searchemployee-opendialogbutton">SearchEmployee</button>

            <button id="newemployee-opendialogbutton">New Employee</button>
            <button id="newpost-opendialogbutton">New Post</button>

            <dialog class="styled-dialog" id="newpost-dialog">
                <form hx-validate="true" class="form-dialog" id="newpost-form"
                    hx-post="http://localhost:8080/app/postServlet" hx-swap="innerHTML" hx-trigger="submit">
                    <input type="hidden" name="action" value="addnewpost">

                    <label>Post Label:
                        <input type="text" name="postlabel" required pattern="[A-ZÃ€-Ã][a-zÃ -Ã¯]+(\s[A-ZÃ€-Ã][a-zÃ -Ã¯]+)*">
                    </label>

                    <label>Wage â‚¬/h:
                        <input type="number" name="postwage" required min="0">
                    </label>

                    <div class="dialog-form-buttonWrapper">
                        <input type="submit" value="submit" id="newpost-form-submitBtn">
                        <input type="button" value="close" id="newpost-closeButton">
                    </div>
                </form>


            </dialog>

            <dialog class="styled-dialog" id="searchemployee-dialog">

                <form class="form-dialog" id="searchemployee-form">
                    <input type="hidden" name="action" value="searchemployee">
                    <label for="id">EmployeeId:
                        <input type="number" name="employeeid">
                    </label>

                    <label for="name"> Name:
                        <input type="text" name="name" pattern="[A-Z][a-z]+">
                    </label>

                    <label for="lastname"> LastName:
                        <input type="text" name="lastname" pattern="[A-Z][a-z]+">
                    </label>



                    <select name="department" id="searchemployee-department-options"
                        hx-get="http://localhost:8080/app/departmentServlet?action=getdepartmentlist"
                        hx-trigger="click from:#searchemployee-opendialogbutton" hx-swap="innerHTML">
                    </select>

                    <div class="dialog-form-buttonWrapper">
                        <input type="button" value="submit" id="dialog-form-submitBtn"
                            hx-post="http://localhost:8080/app/employeeServlet" hx-swap="innerHTML"
                            hx-target="#bodytable">

                        <input type="button" value="close" class="dialog-form-closeButton"
                            id="searchemployee-closeButton">
                    </div>

                </form>
            </dialog>

            <dialog class="styled-dialog" id="newemployee-dialog">
                <form class="form-dialog" id="newemployee-form">

                    <!--Minimum pattern just to ensure only allowed characters will be transmited to the Backend  -->
                    <label>Name: <input type="text" name="name" pattern="[A-Z][a-z]+" required></label>
                    <label>Last name: <input type="text" name="lastname" pattern="[A-Z][a-z]+" required></label>
                    <input type="hidden" name="action" value="addemployee">
                    <select required name="rank">
                        <option value="" disabled selected>Select rank</option>
                        <option value="junior">Junior</option>
                        <option value="mid-level">Mid-level</option>
                        <option value="senior">Senior</option>

                    </select>

                    <select required name="post" hx-get="http://localhost:8080/app/postServlet?action=getpostlist"
                        hx-trigger="click from:#newemployee-opendialogbutton" hx-swap="innerHTML">
                    </select>

                    <select required name="department" id="newemployee-department-options"
                        hx-get="http://localhost:8080/app/departmentServlet?action=getdepartmentlist"
                        hx-trigger="click from:#newemployee-opendialogbutton" hx-swap="innerHTML">
                    </select>

                    <div class="dialog-form-buttonWrapper">
                        <input type="button" value="submit" id="newemployee-form-submitBtn">
                        <input type="button" value="close" id="newemployee-closeButton">
                    </div>

                </form>
            </dialog>

            <dialog class="styled-dialog" id="newlycreatedemployee-dialog">
                <form class="form-dialog" id="newlycreatedemployee-form">
                    <label>Employee was successfully created</label>
                    <!-- The following fields are filled once the response is get from the backend  -->
                    <label>Username: <p id="newlycreatedemployee-username"></p></label>
                    <label>Password: <p id="newlycreatedemployee-password"></p></label>
                    <div class="dialog-form-buttonWrapper">
                        <input type="button" value="close" id="newlycreatedemployee-closeButton">
                    </div>
                </form>
            </dialog>

        </div>

        <div id="employees-table">

            <dialog class="styled-dialog" id="modifyemployee-dialog">
                <form class="form-dialog" id="modifyemployee-form">
                    <input type="hidden" name="action" value="modifyemployee">
                    <label>Name: <input type="text" id="name-input" name="modifyemployee-name-input"
                            pattern="[A-Z][a-z]+"></label>
                    <label>Lastname: <input type="text" id="lastname-input" name="modifyemployee-lastname-input"
                            pattern="[A-Z][a-z]+"></label>
                    <div id="password-togglestyle-div">
                        <label>Password: <input type="password" id="password-input" name="modifyemployee-password-input"
                                pattern="[\w\sÃ€-ÃÃ -Ã¯%Â°#&^*$@]{4,}">
                        </label>

                    </div>
                    <select name="rank" id="rank-select">
                        <option value="junior">Junior</option>
                        <option value="midlevel">Mid-level</option>
                        <option value="senior">Senior</option>
                    </select>

                    <select required name="modifyEmployee-postList" id="post-select"
                        hx-get="http://localhost:8080/app/postServlet?action=getpostlist" hx-trigger="load">

                    </select>
                    <div class="dialog-form-buttonWrapper">
                        <input type="button" value="submit" id="modifyemployee-form-submitBtn">
                        <input type="button" value="close" id="modifyemployee-closeButton">

                    </div>
                </form>
            </dialog>

            <dialog class="styled-dialog" id="removeemployee-dialog">
                <form class="form-dialog" id="removeemployee-form">
                    <p>Are you sure wanting to delete this Employee?</p>
                    <div>
                        <input type="button" value="Yes" id="removeemployee-submitButton">
                        <input type="button" value="No" id="removeemployee-closeButton">
                    </div>

                </form>
            </dialog>


            <!-- Not a real table but at least it s responsive -->
            <div class="row">
                <div>Name</div>
                <div>Post</div>
                <div>Department</div>
                <div>Rank</div>
                <div>Action</div>
            </div>
            <div id="bodytable" hx-get="http://localhost:8080/app/employeeServlet?action=getallemployees"
                hx-trigger="load" hx-swap="innerHTML">

            </div>


        </div>

    </main>
</body>

</html>